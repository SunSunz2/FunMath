<!--Sun Banchasawan-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quick Math+!</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Fredoka One', cursive;
      background: linear-gradient(135deg, #cceeff, #e0f7ff);
      color: #003366;
      text-align: center;
      padding-top: 40px;
      margin: 0;
    }

    h1 {
      font-size: 40px;
      color: #0066cc;
      margin-bottom: 20px;
      text-shadow: 1px 2px 0 #fff;
    }

    #gameBox {
      background: white;
      border-radius: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      padding: 40px;
      max-width: 600px;
      margin: auto;
      display: none;
    }

    #question {
      font-size: 32px;
      margin: 20px 0;
      color: #004080;
    }

    .answers {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }

    .answer {
      background-color: #66ccff;
      border: none;
      border-radius: 20px;
      padding: 20px 30px;
      font-size: 24px;
      cursor: pointer;
      color: white;
      transition: 0.2s;
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }

    .answer:hover {
      background-color: #3399ff;
      transform: scale(1.1);
    }

    #score, #global-timer, #highscore {
      font-size: 20px;
      margin: 10px 0;
      color: #005580;
    }

    #gameover {
      color: red;
      font-size: 28px;
      margin-top: 20px;
      display: none;
    }

    #restartButton, #menuButton {
      background-color: #66ccff;
      color: white;
      border: none;
      font-size: 20px;
      padding: 12px 24px;
      margin: 10px;
      border-radius: 20px;
      cursor: pointer;
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
      transition: 0.2s;
    }

    #restartButton:hover, #menuButton:hover {
      background-color: #3399ff;
      transform: scale(1.05);
    }

    #skillButton {
      background-color: #44cc88;
      color: white;
      border: none;
      font-size: 18px;
      padding: 12px 24px;
      border-radius: 20px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: 0.2s;
      margin-top: 10px;
      display: none;
    }

    #skillButton:hover {
      background-color: #33aa77;
      transform: scale(1.05);
    }

    #startScreen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    #modeButtons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }

    .modeBtn {
      background-color: #66ccff;
      color: white;
      font-size: 32px;
      border: none;
      padding: 20px 30px;
      border-radius: 20px;
      cursor: pointer;
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
      transition: 0.2s;
    }

    .modeBtn:hover {
      background-color: #3399ff;
      transform: scale(1.1);
    }

    #muteButton {
      background-color: #66ccff;
      color: white;
      border: none;
      font-size: 24px;
      padding: 16px 32px;
      border-radius: 20px;
      cursor: pointer;
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
      transition: 0.2s;
      margin-top: 20px;
      display: none;
    }

    #muteButton:hover {
      background-color: #3399ff;
      transform: scale(1.05);
    }
  </style>
</head>
<body>

  <div id="startScreen">
    <h1>üåü Quick Math+! üåü</h1>
    <p>Select Game Mode:</p>
    <div id="modeButtons">
      <button class="modeBtn" data-mode="+">‚ûï</button>
      <button class="modeBtn" data-mode="-">‚ûñ</button>
      <button class="modeBtn" data-mode="*">‚úñÔ∏è</button>
      <button class="modeBtn" data-mode="/">‚ûó</button>
      <button class="modeBtn" data-mode="random">üé≤ Random</button>
    </div>
  </div>

  <div id="gameBox">
    <div id="question">Loading...</div>
    <div class="answers" id="answers"></div>
    <div id="score">Score: 0</div>
    <div id="highscore">Highest Score: 0</div>
    <div id="global-timer">15</div>
    <button id="skillButton">üïê Use +5 Sec</button>

    <div id="gameover">
      Game Over!
      <div style="margin-top: 20px;">
        <button id="restartButton">üîÅ Restart</button>
        <button id="menuButton">üè† Main Menu</button>
      </div>
    </div>

    <button id="muteButton">üîä Mute</button>
  </div>

  <audio id="bgMusic" loop>
    <source src="Mathfun.mp3" type="audio/mpeg">
  </audio>

  <script>
    let score = 0;
    let questionTime = 10;
    let questionTimeLeft = 10;
    let questionTimer, countdownInterval;
    let selectedMode = "random";
    const highScores = JSON.parse(localStorage.getItem("mathHighScores") || "{}");

    let skillReady = false;
    let correctAnswersSinceSkill = 0;

    const music = document.getElementById("bgMusic");
    const muteButton = document.getElementById("muteButton");

    muteButton.addEventListener("click", () => {
      if (music.paused) {
        music.play();
        muteButton.textContent = "üîä Mute";
      } else {
        music.pause();
        muteButton.textContent = "üîá Unmute";
      }
    });

    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function getRandomProblem() {
      let ops = ['+', '-', '*', '/'];
      let op;

      if (selectedMode === 'random') {
        if (score < 5) ops = ['+', '-'];
        else if (score < 10) ops = ['+', '-', '*'];
        op = ops[Math.floor(Math.random() * ops.length)];
      } else {
        op = selectedMode;
      }

      let a = getRandomInt(1, score + 5);
      let b = getRandomInt(1, score + 5);
      let question, answer;

      if (op === '+') {
        answer = a + b;
        question = `${a} + ${b}`;
      } else if (op === '-') {
        if (a < b) [a, b] = [b, a];
        answer = a - b;
        question = `${a} - ${b}`;
      } else if (op === '*') {
        answer = a * b;
        question = `${a} √ó ${b}`;
      } else if (op === '/') {
        answer = a;
        b = getRandomInt(1, score + 3);
        a = answer * b;
        question = `${a} √∑ ${b}`;
      }

      return { question, answer, op };
    }

    function calculateTimeForQuestion(op) {
      let baseTime = 5;
      if (op === '+' || op === '-') baseTime += Math.min(score, 5);
      if (op === '*' || op === '/') baseTime += Math.min(score, 10);
      return Math.min(Math.max(baseTime, 5), 15);
    }

    function updateTimerDisplay() {
      document.getElementById("global-timer").textContent = `${questionTimeLeft}`;
    }

    function startCountdown(duration) {
      clearInterval(countdownInterval);
      questionTimeLeft = duration;
      updateTimerDisplay();

      countdownInterval = setInterval(() => {
        questionTimeLeft--;
        updateTimerDisplay();
        if (questionTimeLeft <= 0) {
          clearInterval(countdownInterval);
          gameOver("‚è∞ Time's Up!");
        }
      }, 1000);
    }

    function generateQuestion() {
      clearInterval(countdownInterval);

      const { question, answer, op } = getRandomProblem();
      questionTime = calculateTimeForQuestion(op);

      document.getElementById("question").textContent = question;

      const answers = new Set([answer]);
      while (answers.size < 4) {
        let wrong = answer + getRandomInt(-10, 10);
        if (wrong !== answer && wrong >= 0) answers.add(wrong);
      }

      const answerContainer = document.getElementById("answers");
      answerContainer.innerHTML = "";
      [...answers].sort(() => Math.random() - 0.5).forEach(num => {
        const btn = document.createElement("div");
        btn.className = "answer";
        btn.textContent = num;
        btn.onclick = () => {
          if (num === answer) {
            score++;
            correctAnswersSinceSkill++;
            if (!skillReady && correctAnswersSinceSkill >= 5) {
              skillReady = true;
              correctAnswersSinceSkill = 0;
              document.getElementById("skillButton").style.display = "inline-block";
            }

            document.getElementById("score").textContent = `Score: ${score}`;
            updateHighScore();
            generateQuestion();
          } else {
            gameOver("Wrong Answer!");
          }
        };
        answerContainer.appendChild(btn);
      });

      startCountdown(questionTime);
    }

    function updateHighScore() {
      if (!highScores[selectedMode] || score > highScores[selectedMode]) {
        highScores[selectedMode] = score;
        localStorage.setItem("mathHighScores", JSON.stringify(highScores));
        document.getElementById("highscore").textContent = `Highest Score: ${score}`;
      }
    }

    function showHighScoreForMode() {
      const modeScore = highScores[selectedMode] || 0;
      document.getElementById("highscore").textContent = `Highest Score: ${modeScore}`;
    }

    function gameOver(message = "Game Over!") {
      clearInterval(countdownInterval);
      document.getElementById("gameover").style.display = "block";
      document.getElementById("question").textContent = "Game Over!";
      document.getElementById("answers").innerHTML = "";
      document.getElementById("skillButton").style.display = "none";
      skillReady = false;

      document.getElementById("gameover").innerHTML = `
        ${message}
        <div style="margin-top: 20px;">
          <button id="restartButton">üîÅ Restart</button>
          <button id="menuButton">üè† Main Menu</button>
        </div>
      `;

      document.getElementById("restartButton").onclick = () => {
        document.getElementById("gameover").style.display = "none";
        startGame();
      };

      document.getElementById("menuButton").onclick = () => {
        clearInterval(countdownInterval);
        document.getElementById("gameBox").style.display = "none";
        document.getElementById("startScreen").style.display = "flex";
        document.getElementById("gameover").style.display = "none";
      };
    }

    function startGame() {
      score = 0;
      correctAnswersSinceSkill = 0;
      skillReady = false;
      document.getElementById("skillButton").style.display = "none";
      document.getElementById("score").textContent = `Score: ${score}`;
      document.getElementById("gameover").style.display = "none";
      showHighScoreForMode();
      generateQuestion();
    }

    document.querySelectorAll(".modeBtn").forEach(button => {
      button.addEventListener("click", () => {
        selectedMode = button.dataset.mode;
        document.getElementById("startScreen").style.display = "none";
        document.getElementById("gameBox").style.display = "block";
        muteButton.style.display = "inline-block";
        music.volume = 0.3;
        music.play().catch(err => console.log("Audio Play Error:", err));
        startGame();
      });
    });

    document.getElementById("skillButton").addEventListener("click", () => {
      if (skillReady) {
        questionTimeLeft += 5;
        updateTimerDisplay();
        skillReady = false;
        document.getElementById("skillButton").style.display = "none";
      }
    });
  </script>

</body>
</html>
